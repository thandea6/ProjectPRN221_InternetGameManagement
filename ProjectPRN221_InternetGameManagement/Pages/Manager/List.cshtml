@page
@model ProjectPRN221_InternetGameManagement.Pages.Manager.ListModel
@{
    ViewData["Title"] = "Manage Users";
    Layout = null; // Tắt layout cho trang này
}

<!-- Nút Logout ở góc phải trên cùng -->
<div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 10px;">
    <button onclick="location.href='@Url.Page("/Product/List")'" style="width: 100px; height: 40px;">Product</button>
    <form method="post" asp-page-handler="Logout">
        <button type="submit" style="width: 100px; height: 40px;">Logout</button>
    </form>
</div>

<h2>Manage Users</h2>

<!-- Thanh tìm kiếm người dùng -->
<form method="get">
    <input type="text" asp-for="SearchQuery" placeholder="Search by username" />
    <button type="submit">Search</button>
</form>

<!-- Nút thêm tài khoản người dùng mới -->
<button onclick="location.href='@Url.Page("/Manager/AddUser")'">Add User</button>

<!-- Bảng hiển thị danh sách người dùng -->
<table border="1" cellpadding="10" cellspacing="0">
    <thead>
        <tr>
            <th>Username</th>
            <th>Role</th>
            <th>Time</th> <!-- Thêm cột Time -->
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var user in Model.Users)
        {
            <tr>
                <td>@user.Username</td>
                <td>@user.Role</td>
                <td>@user.FormattedTime</td> <!-- Hiển thị thời gian theo định dạng 00h00m -->
                <td>
                    <!-- Nút Update để cập nhật mật khẩu -->
                    <button onclick="location.href='@Url.Page("/Manager/Update", new { id = user.Id })'">Update</button>

                    <!-- Nút Delete để xóa tài khoản người dùng -->
                    <button onclick="confirmDelete('@user.Id')">Delete</button>

                    <!-- Nút Deposit để chuyển đến trang nạp tiền -->
                    <button onclick="location.href='@Url.Page("/Manager/AddTime", new { id = user.Id })'">Deposit</button>

                    <!-- Nút Pay để chuyển đến trang thanh toán -->
                    <button onclick="location.href='@Url.Page("/Manager/Pay", new { accountId = user.Id })'">Pay</button>
                </td>
            </tr>
        }
    </tbody>
</table>

<script>
    // Hàm xác nhận xóa tài khoản
    function confirmDelete(userId) {
        if (confirm("Are you sure you want to delete this account?")) {
            location.href = '@Url.Page("/Manager/Delete")?id=' + userId;
        }
    }
</script>